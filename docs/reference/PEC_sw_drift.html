<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate predicted environmental concentrations in surface water due to drift — PEC_sw_drift • pfm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate predicted environmental concentrations in surface water due to drift — PEC_sw_drift"><meta name="description" content="This is a basic, vectorised form of a simple calculation of a contaminant
concentration in surface water based on complete, instantaneous mixing
with input via spray drift."><meta property="og:description" content="This is a basic, vectorised form of a simple calculation of a contaminant
concentration in surface water based on complete, instantaneous mixing
with input via spray drift."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pfm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jranke/pfm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate predicted environmental concentrations in surface water due to drift</h1>
      <small class="dont-index">Source: <a href="https://github.com/jranke/pfm/blob/HEAD/R/PEC_sw_drift.R" class="external-link"><code>R/PEC_sw_drift.R</code></a></small>
      <div class="d-none name"><code>PEC_sw_drift.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a basic, vectorised form of a simple calculation of a contaminant
concentration in surface water based on complete, instantaneous mixing
with input via spray drift.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PEC_sw_drift</span><span class="op">(</span></span>
<span>  <span class="va">rate</span>,</span>
<span>  applications <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  water_depth <span class="op">=</span> <span class="fu">as_units</span><span class="op">(</span><span class="st">"30 cm"</span><span class="op">)</span>,</span>
<span>  drift_percentages <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drift_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"JKI"</span>, <span class="st">"RF"</span><span class="op">)</span>,</span>
<span>  crop_group_JKI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ackerbau"</span>, <span class="st">"Obstbau frueh"</span>, <span class="st">"Obstbau spaet"</span>, <span class="st">"Weinbau frueh"</span>,</span>
<span>    <span class="st">"Weinbau spaet"</span>, <span class="st">"Hopfenbau"</span>, <span class="st">"Flaechenkulturen &gt; 900 l/ha"</span>, <span class="st">"Gleisanlagen"</span><span class="op">)</span>,</span>
<span>  crop_group_RF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"arable"</span>, <span class="st">"hops"</span>, <span class="st">"vines, late"</span>, <span class="st">"vines, early"</span>, <span class="st">"fruit, late"</span>,</span>
<span>    <span class="st">"fruit, early"</span>, <span class="st">"aerial"</span><span class="op">)</span>,</span>
<span>  distances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rautmann"</span>, <span class="st">"FOCUS"</span><span class="op">)</span>,</span>
<span>  water_width <span class="op">=</span> <span class="fu">as_units</span><span class="op">(</span><span class="st">"100 cm"</span><span class="op">)</span>,</span>
<span>  side_angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  rate_units <span class="op">=</span> <span class="st">"g/ha"</span>,</span>
<span>  PEC_units <span class="op">=</span> <span class="st">"µg/L"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>Application rate in units specified below, or with units defined via the
<code>units</code> package.</p></dd>


<dt id="arg-applications">applications<a class="anchor" aria-label="anchor" href="#arg-applications"></a></dt>
<dd><p>Number of applications for selection of drift percentile</p></dd>


<dt id="arg-water-depth">water_depth<a class="anchor" aria-label="anchor" href="#arg-water-depth"></a></dt>
<dd><p>Depth of the water body in cm</p></dd>


<dt id="arg-drift-percentages">drift_percentages<a class="anchor" aria-label="anchor" href="#arg-drift-percentages"></a></dt>
<dd><p>Percentage drift values for which to calculate PECsw.
Overrides 'drift_data' and 'distances' if not NULL.</p></dd>


<dt id="arg-drift-data">drift_data<a class="anchor" aria-label="anchor" href="#arg-drift-data"></a></dt>
<dd><p>Source of drift percentage data. If 'JKI', the <a href="drift_data_JKI.html">drift_data_JKI</a>
included in the package is used. If 'RF', the Rautmann drift data are calculated
either in the original form or integrated over the width of the water body, depending
on the 'formula' argument.</p></dd>


<dt id="arg-crop-group-jki">crop_group_JKI<a class="anchor" aria-label="anchor" href="#arg-crop-group-jki"></a></dt>
<dd><p>When using the 'JKI' drift data, one of the German names
as used in <a href="drift_data_JKI.html">drift_data_JKI</a>. Will only be used if drift_data is 'JKI'.</p></dd>


<dt id="arg-crop-group-rf">crop_group_RF<a class="anchor" aria-label="anchor" href="#arg-crop-group-rf"></a></dt>
<dd><p>One of the crop groups as used in <a href="drift_parameters_focus.html">drift_parameters_focus</a></p></dd>


<dt id="arg-distances">distances<a class="anchor" aria-label="anchor" href="#arg-distances"></a></dt>
<dd><p>The distances in m for which to get PEC values</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>By default, the original Rautmann formula is used. If you
specify "FOCUS", mean drift input over the width of the water body is
calculated as described in Chapter 5.4.5 of the FOCUS surface water guidance</p></dd>


<dt id="arg-water-width">water_width<a class="anchor" aria-label="anchor" href="#arg-water-width"></a></dt>
<dd><p>Width of the water body in cm</p></dd>


<dt id="arg-side-angle">side_angle<a class="anchor" aria-label="anchor" href="#arg-side-angle"></a></dt>
<dd><p>The angle of the side of the water relative to the bottom which
is assumed to be horizontal, in degrees. The SYNOPS model assumes 45 degrees here.</p></dd>


<dt id="arg-rate-units">rate_units<a class="anchor" aria-label="anchor" href="#arg-rate-units"></a></dt>
<dd><p>Defaults to g/ha. For backwards compatibility, only used
if the specified rate does not have <a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">units::units</a>].</p></dd>


<dt id="arg-pec-units">PEC_units<a class="anchor" aria-label="anchor" href="#arg-pec-units"></a></dt>
<dd><p>Requested units for the calculated PEC. Only µg/L currently supported</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The predicted concentration in surface water</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is recommened to specify the arguments <code>rate</code>, <code>water_depth</code> and
<code>water_width</code> using <a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">units::units</a> from the <code>units</code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="drift_parameters_focus.html">drift_parameters_focus</a>, <a href="drift_percentages_rautmann.html">drift_percentages_rautmann</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Ranke</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92333333 0.19000000 0.09666667 0.05000000 </span>
<span class="r-in"><span><span class="co"># Alternatively, we can use the formula for a single application to</span></span></span>
<span class="r-in"><span><span class="co"># "Ackerbau" from the paper</span></span></span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91976667 0.19064473 0.09680051 0.04915079 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This makes it possible to also use different distances</span></span></span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, distances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        3 m        5 m        6 m       10 m       20 m       50 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91976667 0.31415827 0.19064473 0.15951494 0.09680051 0.04915079 0.02006434 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      100 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01018774 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or consider aerial application</span></span></span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, distances <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span>,</span></span>
<span class="r-in"><span>  crop_group_RF <span class="op">=</span> <span class="st">"aerial"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        3 m        5 m        6 m       10 m       20 m       50 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16.8233333 11.0585820  9.0986174  8.4866460  6.9825178  4.7004640  1.8820816 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      100 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.9417586 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using custom drift percentages is also supported</span></span></span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_percentages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.77</span>, <span class="fl">0.95</span>, <span class="fl">0.57</span>, <span class="fl">0.48</span>, <span class="fl">0.29</span>, <span class="fl">0.15</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2.77 %     0.95 %     0.57 %     0.48 %     0.29 %     0.15 %     0.06 % </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92333333 0.31666667 0.19000000 0.16000000 0.09666667 0.05000000 0.02000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.03 % </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The influence of assuming a 45° angle of the sides of the waterbody and the width of the</span></span></span>
<span class="r-in"><span><span class="co"># waterbody can be illustrated</span></span></span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92333333 0.19000000 0.09666667 0.05000000 </span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91976667 0.19064473 0.09680051 0.04915079 </span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span>, formula <span class="op">=</span> <span class="st">"FOCUS"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.64246407 0.17414541 0.09235842 0.04798749 </span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span>, formula <span class="op">=</span> <span class="st">"FOCUS"</span>, side_angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91780582 0.24877916 0.13194060 0.06855356 </span>
<span class="r-in"><span><span class="fu">PEC_sw_drift</span><span class="op">(</span><span class="fl">100</span>, drift_data <span class="op">=</span> <span class="st">"RF"</span>, formula <span class="op">=</span> <span class="st">"FOCUS"</span>, side_angle <span class="op">=</span> <span class="fl">45</span>, water_width <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Units: [µg/L]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 m        5 m       10 m       20 m </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.60169999 0.18937304 0.10402698 0.05517095 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

